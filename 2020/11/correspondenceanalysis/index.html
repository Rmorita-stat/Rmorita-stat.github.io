<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>
        
        SUCRE HECACHA
        
    </title>
    <meta name="viewport" id="viewport" content="width=device-width, initial-scale=1">
    <link rel='icon' type='image/x-icon' href="https://rmorita-stat.github.io/images/logo2.png" />
    <link rel="apple-touch-icon" href="https://rmorita-stat.github.io/images/logo2.png"><link rel="stylesheet" href="https://rmorita-stat.github.io/scss/style.css">
    
    <link rel="stylesheet" href="https://rmorita-stat.github.io/css/syntax.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet">
    <script src="https://rmorita-stat.github.io/js/highlight.min.js"></script>
    <link rel="stylesheet" href="https://rmorita-stat.github.io/scss/highlight.css">
    
    <link rel="stylesheet" href="https://rmorita-stat.github.io/scss/custom.css">
    
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'Your Google Analytics tracking id', 'auto');
        ga('send', 'pageview');
    </script>
    
    
    <meta name="generator" content="Hugo 0.71.0" /></head>


<body>
<div class="header">
    <div class="site-logo__wrap">
        <div id="site-button">
            <div></div>
        </div>
        
        <div class=' site-logo '>
            <a href="https://rmorita-stat.github.io/"><img src="https://rmorita-stat.github.io/images/logo.png" /></a>
        </div>
    </div>
    
<div class=' site-nav u-font ' id="nav-bar">
    
    <div class="site-nav__wrap">
        <a class="site-nav__el" href="/" >HOME</a>
    </div>
    
    <div class="site-nav__wrap">
        <a class="site-nav__el" href="/post" >BLOG</a>
    </div>
    
    <div class="site-nav__wrap">
        <a class="site-nav__el" href="/about" >ABOUT</a>
    </div>
    
    <div class="site-nav__wrap">
        <a class="site-nav__el" href="/tags/" >TAGS</a>
    </div>
    
</div>

</div>
<div class="main">

<div class="main-content">
    <div class="main-content__date">
        <h4 id="date"> 2020.11.07 00:00 </h4>
    </div>
    <div class="main-content__title">
        <h1 id="title">対応分析について</h1>
    </div>
    <div class="main-content__article">
        <article id="content">
            <h1 id="はじめに">はじめに</h1>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/255m-RxlrCw" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p>秋は晴天の日が多いですネ。晴れた空の日曜日は外に出かけてみたくもなりますが、草野さんは部屋で昨日の夢を思い出しながら妄想するのもいいと言っています。なるほど…</p>
<p>さてこの記事は<a href="https://qiita.com/advent-calendar/2020/stan">Stan Advent calendar</a>12月12日にエントリーしている記事（未投稿）を補完するために先に作成した記事になります。</p>
<p>この記事では多変量解析の一つである<strong>対応分析</strong>を取り上げます。</p>
<p>対応分析は多変量のカテゴリカルデータに用いられる分析で、分割表の結果を視覚的に表現するために使われる統計的手法です。</p>
<p>実は対応分析は私の修士研究で使用した解析手法なのですが、対応分析の付置はデータ数に依存しないことから、座標を得るだけでその信頼性が確認できないところに当時問題を感じていました。<br>
この問題に対しベイズ的なアプローチをとることで解決できないかと錯誤した結果、うまくいったぽいので、Stanアドベントカレンダーではその結果について記事にする予定です。</p>
<p>本記事ではその前段階として、対応分析の理論的な枠組みと結果の解釈の方法などについて理解した範囲でまとめます。</p>
<p>本記事の構成は以下のとおりとします。</p>
<!-- raw HTML omitted -->
<ul>
<li><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">はじめに</a></li>
<li><a href="#%E5%AF%BE%E5%BF%9C%E5%88%86%E6%9E%90%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">対応分析について</a>
<ul>
<li><a href="#%E5%AF%BE%E5%BF%9C%E5%88%86%E6%9E%90%E6%B3%95%E3%81%8C%E3%82%84%E3%82%8D%E3%81%86%E3%81%A8%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%81%93%E3%81%A8">対応分析法がやろうとしていること</a></li>
<li><a href="#%E8%A1%8C%E9%A0%85%E7%9B%AE%E3%83%BB%E5%88%97%E9%A0%85%E7%9B%AE%E3%81%AE%E5%BA%A7%E6%A8%99%E3%81%AE%E6%B1%82%E3%82%81%E6%96%B9">行項目・列項目の座標の求め方</a></li>
<li><a href="#%E5%BE%97%E3%82%89%E3%82%8C%E3%81%9F%E8%BB%B8%E3%81%AE%E6%80%A7%E8%B3%AA">得られた軸の性質</a></li>
</ul>
</li>
<li><a href="#%E5%88%86%E6%9E%90%E4%BE%8B">分析例</a>
<ul>
<li><a href="#r%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E8%A8%88%E7%AE%97%E4%BE%8B">Rを用いた計算例</a></li>
<li><a href="#%E7%B5%90%E6%9E%9C%E3%81%AE%E8%A7%A3%E9%87%88">結果の解釈</a></li>
</ul>
</li>
<li><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB">終わりに</a>
<ul>
<li><a href="#%E4%BB%8A%E5%9B%9E%E8%AA%AC%E6%98%8E%E3%81%A7%E3%81%8D%E3%81%AA%E3%81%8B%E3%81%A3%E3%81%9F%E3%81%93%E3%81%A8">今回説明できなかったこと</a></li>
<li><a href="#%E6%AC%A1%E5%9B%9E%E8%A7%A6%E3%82%8C%E3%81%9F%E3%81%84%E3%81%93%E3%81%A8">次回触れたいこと</a></li>
</ul>
</li>
</ul>
<!-- raw HTML omitted -->
<p>参考にした論文は<a href="https://www.jstage.jst.go.jp/article/jscswabun/7/2/7_KJ00002502205/_article/-char/ja/">こちら</a>です。  <br>
この論文はもうだいぶ古いものですが、対応分析の理論が簡潔に記載されています。また、先に述べた対応分析の付置の信頼性の問題を解決してくれています<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>が、今回は信頼区間の問題には極力触れずにいきます。</p>
<h1 id="対応分析について">対応分析について</h1>
<p>対応分析とは分割表<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>など、カテゴリカルな行と列のデータを視覚的に表現することで、項目間の関係を把握しようとする手法です。コレスポンデンス分析とも呼ばれ、数理的には林先生の数量化理論第Ⅲ類と同等のものとされています。</p>
<h2 id="対応分析法がやろうとしていること">対応分析法がやろうとしていること</h2>
<p>$i$行$j$列が$f_{ij}$（$i=1 … M$、$j = 1 … N$）である$M$行$N$列の分割表について考えます。<br>
以下、この分割表の行項目$I$を、関係性を把握したい対象、列項目$J$を変量とみなして説明します。</p>
<p>各行・列および全項目の総和を以下のように表記します。
<div style="overflow-x:auto;">
  
$$
f_{i.} = ∑_{j=1}^{N}f_{ij} ~,~~ f_{.j} = ∑_{i=1}^{M}f_{ij} ~,~~ Sum = ∑_{j=1}^{N} ∑_{i=1}^{M} f_{ij}
$$

</div>
対応分析は、結局のところ以下の$M$×$N$行列$\boldsymbol{X}$を$M$個の$N$変量のデータととらえた主成分分析と言えます。
<div style="overflow-x:auto;">
  
$$
\boldsymbol{X} = \boldsymbol{P} _{I}^{-1} \boldsymbol{P} _{IJ} \boldsymbol{P} _{J}^{-1/2}
$$

</div>
ここで、$\boldsymbol{P} _{ij}$ は $f _{ij}/N$を$(i,j)$成分にもつ$M$×$N$行列、$\boldsymbol{P}_I$と$\boldsymbol{P}_J$は以下の単位行列です。
<div style="overflow-x:auto;">
  
$$
\boldsymbol{P}_I = \mathrm{diag} \left[ p_{1.}, …, p_{M.} \right] ~,~~ p_{i.} = f_{i.}/Sum
$$
$$
\boldsymbol{P}_J = \mathrm{diag} \left[ p_{.1}, …, p_{.N} \right] ~,~~ p_{.j} = f_{.j}/Sum
$$

</div></p>
<p>$X$の($i,j$)成分$x_{ij}$は以下のようになっています。
<div style="overflow-x:auto;">
  
$$
x_{ij} = \cfrac{p_{ij}}{p_{i.} \sqrt{p_{,j}}}　\tag{1}
$$

</div>
$p_{ij}$をそのまま使うのではなくその行・列の全体の割合で調整しているようです。この意味合いは次の$\mathcal{\chi}^2$距離について考えると理解できます。</p>
<p>行項目$I$の$i_1$番目と、$i_2$番目の個体の間の$\mathcal{\chi}^2$距離は、
<div style="overflow-x:auto;">
  
$$
\chi^2_{i_{1}i_{2}} = \sqrt{\sum^{N}_{j=1}
\cfrac{\left( \cfrac{p_{i_{1}j}}{p_{i_{1}.}} - \cfrac{p_{i_{2}j}}{p_{i_{2}.}}
\right)^2}{p_{.j}}} = \sqrt{\sum^{N}_{j=1}
\cfrac{\left( \cfrac{f_{i_{1}j}}{f_{i_{1}.}} - \cfrac{f_{i_{2}j}}{f_{i_{2}.}}
\right)^2}{p_{.j}}} \tag{2}
$$

</div>
で計算されます。これは、観測度数が少ない変量ほどより大きく距離に影響するように重みづけられた$f_{ij}/f_{i.}$に関するユークリッド距離になっています（二番目の等号参照）。
そしてこれは、$\boldsymbol{X}$に対するユークリッド距離の計算をすることで求めることができるようになっています（一番目の等号参照）。</p>
<p>対応分析が$(1)$式で計算される行列の主成分分析であるということは、つまり、対応分析とは$(2)$式で定義された$\mathcal{\chi}^2$距離に関する変量の関係を最大限に説明できる軸を求め、それらの軸上に各項目を配置することで、項目間の関係性を視覚的に表示しようとする分析手法である、ということになります<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>。</p>
<h2 id="行項目列項目の座標の求め方">行項目・列項目の座標の求め方</h2>
<p>ここからは基本的に$\boldsymbol{X}$に関する主成分分析についての話です。項目$J$についても同様の行列計算・固有値分解を実行することで軸・座標を得ることができます。ただ、項目$I$と項目$J$それぞれで同じ軸が得られるというところの理論がよくわかりません。ここではそのへんの話は「そういうもの」とさせてください…</p>
<p>$\mathbf{1}_m = (1,\ldots,1) ∈ R^m$として
<div style="overflow-x:auto;">
  
$$
\boldsymbol{\bar{X}}  = \left(
  \begin{array}{ccc}
  \cfrac{1}{M}\sum_{i=1}^{M}x_{i1} & \cfrac{1}{M}\sum_{i=1}^{M}x_{i2} & \cdots & \cfrac{1}{M}\sum_{i=1}^{M}x_{iN} \\\\
  \cfrac{1}{M}\sum_{i=1}^{M}x_{i1} & \ddots & \cdots & \cfrac{1}{M}\sum_{i=1}^{M}x_{iN} \\\\
  \vdots & \vdots & \ddots & \vdots \\\\
  \cfrac{1}{M}\sum_{i=1}^{M}x_{i1} & \cfrac{1}{M}\sum_{i=1}^{M}x_{i2} & \cdots & \cfrac{1}{M}\sum_{i=1}^{M}x_{iN}
  \end{array}\right) = \cfrac{1}{m} \mathbf{1}_m^T \mathbf{1}_m \tag{3}
$$

</div>
とする<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>と、$\boldsymbol{X}$の分散共分散行列$\boldsymbol{Σ}$は</p>
<p><div style="overflow-x:auto;">
  
$$
\boldsymbol{Σ} = \left(\boldsymbol{X}-\boldsymbol{\bar{X}}\right)^T \boldsymbol{P}_I \left(\boldsymbol{X}-\boldsymbol{\bar{X}}\right) \tag{4}
$$

</div>
となります。</p>
<p>…いや冗談だろう、$\boldsymbol{X}$の分散共分散行列は
<div style="overflow-x:auto;">
  
$$
\boldsymbol{Σ} = \cfrac{1}{N}\left(\boldsymbol{X}-\boldsymbol{\bar{X}}\right)^T\left(\boldsymbol{X}-\boldsymbol{\bar{X}}\right) \tag{4'}
$$

</div>
だろ、とはじパタで主成分分析を学んだ私は思ったのですが、$\boldsymbol{P} _{I}$の対角成分が$f _{i.}/Sum$であることを踏まえると、分割表で集計された1つのセルを1観測値とするのではなく、1つの観測事象を1観測値としたときの分散共分散行列を計算する、というような計算をしているっぽいです。錚々たる専門家集団から査読・Acceptされたであろう参考論文にそう書かれているので、ここでは$(4)$式を正としましょう…</p>
<p>とにかく、$(4)$式の$\boldsymbol{\Sigma}$について固有値問題を解いて、得られた固有値を最大固有値から順に$\lambda_{1},\lambda_{2}\ldots,\lambda_{N}$、これらに対応する固有ベクトルを順に$\boldsymbol{l}_1,\boldsymbol{l}_2,\boldsymbol,\boldsymbol{l}_N$とします。これらを用いて、第$k$主成分ベクトルによる項目$I$の数量化スコア$\boldsymbol{z}_{k} = (z_{1k}, \ldots, z_{Nk})$を計算します。</p>
<div style="overflow-x:auto;">
  
$$
\boldsymbol{z} _{k} = \boldsymbol{X} \boldsymbol{l} _{k} = \boldsymbol{P} _{I}^{-1} \boldsymbol{P} _{IJ} \boldsymbol{P} _{j}^{-1/2} \boldsymbol{l} _{k} 　\tag{5}
$$

</div>
<p>これは主成分分析のスコアの計算と同じですね。純粋に項目$I$について主成分ベクトルに対する写像を得ています。</p>
<p>項目$J$の数量化スコア$\boldsymbol{z}^{*}_k$は、項目$I$と同様にして計算することもできますが、項目$I$の数量化スコアから求めることもできるようです。証明は未確認ですが、この式を信用していくことにします。</p>
<div style="overflow-x:auto;">
  
$$
\boldsymbol{z}_k^* = \cfrac{1}{\sqrt{λ_k}}\boldsymbol{P}_J^{-1}\boldsymbol{P}_{IJ}\boldsymbol{z}_k \tag{6}
$$

</div>
<p>$(5)$式および$(6)$式により得られた数量化スコアを同じ図の中に付置したものを同時付置図といい、同時付置図をもとに項目間の関係性をみることになります。</p>
<h2 id="得られた軸の性質">得られた軸の性質</h2>
<p>対応分析によって得られた軸に関する性質をまとめておきます。これらの性質は付置図について考察する際の前提にもなります。またこれらの性質はすべて主成分分析からきたものです。ここで$K=\rm{min}(\mathcal{m},\mathcal{n}) -1$<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup><sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup>とします。</p>
<p><div style="padding: 0.75em; margin-bottom: 1rem; color: #111111; background-color: #d9c68c; border: 1px solid transparent; border-radius: 0.25rem;">
 <center>
第$k$数量化スコアの平均は0$\left(∑_{k=1}^{K} f_{i.}z_{ik}= 0\right)$
</center>
</div>


<div style="padding: 0.75em; margin-bottom: 1rem; color: #111111; background-color: #a89456; border: 1px solid transparent; border-radius: 0.25rem;">
 <center>
第$k$数量化スコアの分散は$\lambda_k$
</center>
</div>


<div style="padding: 0.75em; margin-bottom: 1rem; color: #111111; background-color: #d9c68c; border: 1px solid transparent; border-radius: 0.25rem;">
 <center>
各固有ベクトルは互いに直行する=数量化スコアは無相関($Cov(z_{k1}, z_{k2}) = 0$)  
</center>
</div>


<div style="padding: 0.75em; margin-bottom: 1rem; color: #111111; background-color: #a89456; border: 1px solid transparent; border-radius: 0.25rem;">
 <center>
各数量化スコアによる全データ変動の説明割合は、$\cfrac{\lambda_{k}}{\sum_{k=1}^{K}\lambda_k}$となる
</center>
</div>

</p>
<h1 id="分析例">分析例</h1>
<h2 id="rを用いた計算例">Rを用いた計算例</h2>
<p>実際に対応分析をやってみます。<br>
サンプルデータは参考論文にあった貴乃花現役時代の大相撲6場所の幕内力士20人の勝ち数と決まり手の関係です。</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="n">smo_data</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">19</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">22</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">,</span>
                              <span class="m">14</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">24</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">,</span>
                              <span class="m">11</span><span class="p">,</span><span class="m">13</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">25</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">13</span><span class="p">,</span><span class="m">31</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span>
                              <span class="m">8</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">19</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">28</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">14</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">4</span><span class="p">,</span>
                              <span class="m">5</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">18</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span>
                              <span class="m">25</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">18</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">23</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">,</span>
                              <span class="m">7</span><span class="p">,</span><span class="m">17</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="n">byrow</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">7</span><span class="p">)</span>

<span class="nf">colnames</span><span class="p">(</span><span class="n">smo_data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;寄り&#34;</span><span class="p">,</span><span class="s">&#34;押し&#34;</span><span class="p">,</span><span class="s">&#34;投げ&#34;</span><span class="p">,</span><span class="s">&#34;引き&#34;</span><span class="p">,</span><span class="s">&#34;送り&#34;</span><span class="p">,</span><span class="s">&#34;突き&#34;</span><span class="p">,</span><span class="s">&#34;その他&#34;</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">smo_data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;小錦&#34;</span><span class="p">,</span><span class="s">&#34;琴錦&#34;</span><span class="p">,</span><span class="s">&#34;貴闘力&#34;</span><span class="p">,</span><span class="s">&#34;霧島&#34;</span><span class="p">,</span><span class="s">&#34;栃ノ和歌&#34;</span><span class="p">,</span><span class="s">&#34;水戸錦&#34;</span><span class="p">,</span><span class="s">&#34;若ノ花&#34;</span><span class="p">,</span>
<span class="s">&#34;貴ノ花&#34;</span><span class="p">,</span><span class="s">&#34;武蔵丸&#34;</span><span class="p">,</span><span class="s">&#34;大翔山&#34;</span><span class="p">,</span><span class="s">&#34;安芸ノ島&#34;</span><span class="p">,</span><span class="s">&#34;三杉里&#34;</span><span class="p">,</span><span class="s">&#34;旭道山&#34;</span><span class="p">,</span><span class="s">&#34;舞の海&#34;</span><span class="p">,</span>
<span class="s">&#34;寺尾&#34;</span><span class="p">,</span><span class="s">&#34;琴の若&#34;</span><span class="p">,</span><span class="s">&#34;貴ノ浪&#34;</span><span class="p">,</span><span class="s">&#34;琴富士&#34;</span><span class="p">,</span><span class="s">&#34;隆三杉&#34;</span><span class="p">,</span><span class="s">&#34;春日富士&#34;</span><span class="p">)</span>
</code></pre></div><p>分析例は以下になります<sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup>。変量の数は7なので、得られる軸は6つですが、同時付置図は第1軸と第2軸をもとに作成します。</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># 主成分分析の対象行列作成 ------------------------------------------------------------</span>

<span class="c1"># apply()とか使わないでごめんなさい</span>

<span class="n">N</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">smo_data</span><span class="p">)</span>
<span class="n">m</span> <span class="o">&lt;-</span> <span class="nf">nrow</span><span class="p">(</span><span class="n">smo_data</span><span class="p">)</span>
<span class="n">n</span> <span class="o">&lt;-</span> <span class="nf">ncol</span><span class="p">(</span><span class="n">smo_data</span><span class="p">)</span>

<span class="n">p_i</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">m</span><span class="p">){</span>
  <span class="n">p_i[i]</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">smo_data[i</span><span class="p">,</span><span class="n">]</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
<span class="p">}</span>
<span class="n">P_i</span> <span class="o">&lt;-</span> <span class="nf">diag</span><span class="p">(</span><span class="n">p_i</span><span class="p">)</span>

<span class="n">p_j</span> <span class="o">&lt;-</span> <span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="nf">for</span><span class="p">(</span><span class="n">j</span> <span class="n">in</span> <span class="m">1</span><span class="o">:</span><span class="n">n</span><span class="p">){</span>
  <span class="n">p_j[j]</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">smo_data[</span><span class="p">,</span><span class="n">j]</span><span class="p">)</span><span class="o">/</span><span class="n">N</span>
<span class="p">}</span>
<span class="n">P_j</span> <span class="o">&lt;-</span> <span class="nf">diag</span><span class="p">(</span><span class="n">p_j</span><span class="p">)</span>

<span class="n">P_ij</span> <span class="o">&lt;-</span> <span class="n">smo_data</span><span class="o">/</span><span class="n">N</span>

<span class="n">matpow</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pow</span><span class="o">=</span><span class="m">2</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">y</span> <span class="o">&lt;-</span> <span class="nf">eigen</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
  <span class="n">y</span><span class="o">$</span><span class="n">vectors</span> <span class="o">%*%</span> <span class="nf">diag</span><span class="p">(</span> <span class="p">(</span><span class="n">y</span><span class="o">$</span><span class="n">values</span><span class="p">)</span><span class="n">^pow</span> <span class="p">)</span> <span class="o">%*%</span> <span class="nf">t</span><span class="p">(</span><span class="n">y</span><span class="o">$</span><span class="n">vectors</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">X</span> <span class="o">&lt;-</span> <span class="nf">solve</span><span class="p">(</span><span class="n">P_i</span><span class="p">)</span> <span class="o">%*%</span> <span class="n">P_ij</span> <span class="o">%*%</span> <span class="nf">matpow</span><span class="p">(</span><span class="n">P_j</span><span class="p">,</span> <span class="n">pow</span><span class="o">=</span><span class="p">(</span><span class="m">-1</span><span class="o">/</span><span class="m">2</span><span class="p">))</span>

<span class="c1"># 論文の方法に則った対応分析 -----------------------------------------------------------</span>

<span class="n">X_bar</span> <span class="o">&lt;-</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="nf">colSums</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">),</span><span class="m">20</span><span class="p">),</span> <span class="n">byrow</span><span class="o">=</span><span class="bp">T</span><span class="p">,</span> <span class="n">nrow</span><span class="o">=</span><span class="nf">nrow</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">X_cov</span> <span class="o">&lt;-</span> <span class="nf">t</span><span class="p">((</span><span class="n">X</span> <span class="o">-</span> <span class="n">X_bar</span><span class="p">))</span> <span class="o">%*%</span> <span class="n">P_i</span> <span class="o">%*%</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">X_bar</span><span class="p">)</span>
<span class="n">X_pca</span> <span class="o">&lt;-</span> <span class="nf">eigen</span><span class="p">(</span><span class="n">X_cov</span><span class="p">)</span>

<span class="c1">## eigen() decomposition</span>
<span class="c1">## $values</span>
<span class="c1">## [1] 2.507433e-01 1.341368e-01 8.920454e-02 3.256496e-02 2.038708e-02 1.430728e-02</span>
<span class="c1">## [7] 6.775222e-17</span>

<span class="c1">## $vectors</span>
<span class="c1">##             [,1]        [,2]       [,3]        [,4]        [,5]        [,6]</span>
<span class="c1">## [1,]  0.22994960  0.71371157 -0.2438985  0.15461675  0.08409387 -0.06865717</span>
<span class="c1">## [2,] -0.68444371  0.08147953  0.5365504 -0.03442796 -0.09073808  0.19007387</span>
<span class="c1">## [3,]  0.57769184 -0.34733619  0.2671700 -0.07516444 -0.47057317  0.25705425</span>
<span class="c1">## [4,] -0.30345943 -0.48187904 -0.5352658  0.36673289 -0.18451979 -0.27445628</span>
<span class="c1">## [5,] -0.05982687 -0.19188089 -0.3935578 -0.38378721  0.44535231  0.64529649</span>
<span class="c1">## [6,] -0.09307838  0.04510096 -0.1558085 -0.82883709 -0.24428825 -0.45225825</span>
<span class="c1">## [7,]  0.20149856 -0.30376746  0.3399617 -0.02240822  0.68643479 -0.44363261</span>
<span class="c1">##            [,7]</span>
<span class="c1">## [1,] -0.5852867</span>
<span class="c1">## [2,] -0.4375669</span>
<span class="c1">## [3,] -0.4255399</span>
<span class="c1">## [4,] -0.3812200</span>
<span class="c1">## [5,] -0.2065814</span>
<span class="c1">## [6,] -0.1176471</span>
<span class="c1">## [7,] -0.2881753</span>

<span class="n">rikishi_coord1</span> <span class="o">&lt;-</span> <span class="n">X</span> <span class="o">%*%</span> <span class="n">X_pca</span><span class="o">$</span><span class="n">vectors[</span><span class="p">,</span><span class="m">1</span><span class="n">]</span>
<span class="n">rikishi_coord2</span> <span class="o">&lt;-</span> <span class="n">X</span> <span class="o">%*%</span> <span class="n">X_pca</span><span class="o">$</span><span class="n">vectors[</span><span class="p">,</span><span class="m">2</span><span class="n">]</span>

<span class="n">waza_coord1</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">X_pca</span><span class="o">$</span><span class="n">values[1]</span><span class="p">)</span> <span class="o">*</span> <span class="nf">solve</span><span class="p">(</span><span class="n">P_j</span><span class="p">)</span> <span class="o">%*%</span> <span class="nf">t</span><span class="p">(</span><span class="n">P_ij</span><span class="p">)</span> <span class="o">%*%</span> <span class="n">rikishi_coord1</span>
<span class="n">waza_coord2</span> <span class="o">&lt;-</span> <span class="m">1</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">X_pca</span><span class="o">$</span><span class="n">values[2]</span><span class="p">)</span> <span class="o">*</span> <span class="nf">solve</span><span class="p">(</span><span class="n">P_j</span><span class="p">)</span> <span class="o">%*%</span> <span class="nf">t</span><span class="p">(</span><span class="n">P_ij</span><span class="p">)</span> <span class="o">%*%</span> <span class="n">rikishi_coord2</span>

<span class="c1"># 寄与率の表示 ------------------------------------------------------------------</span>

<span class="n">varsum</span> <span class="o">&lt;-</span> <span class="nf">sum</span><span class="p">(</span><span class="n">X_pca</span><span class="o">$</span><span class="n">values[1</span><span class="o">:</span><span class="m">6</span><span class="n">]</span><span class="p">)</span>
<span class="nf">cat</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&#34;\nContribution Rate of dim%.f: %.3f&#34;</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">6</span><span class="p">,</span><span class="n">X_pca</span><span class="o">$</span><span class="n">values[1</span><span class="o">:</span><span class="m">6</span><span class="n">]</span><span class="o">/</span><span class="n">varsum</span><span class="p">)))</span>

<span class="c1">## Contribution Rate of dim1: 0.463</span>
<span class="c1">## Contribution Rate of dim2: 0.248</span>
<span class="c1">## Contribution Rate of dim3: 0.165</span>
<span class="c1">## Contribution Rate of dim4: 0.060</span>
<span class="c1">## Contribution Rate of dim5: 0.038</span>
<span class="c1">## Contribution Rate of dim6: 0.026</span>

<span class="c1"># プロット --------------------------------------------------------------------</span>

<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggrepel</span><span class="p">)</span>

<span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">()</span> <span class="o">+</span> <span class="nf">theme_light</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">11</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">rikishi_coord1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">rikishi_coord2</span><span class="p">),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">waza_coord1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">waza_coord2</span><span class="p">),</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;blue&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_text_repel</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">rikishi_coord1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">rikishi_coord2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nf">rownames</span><span class="p">(</span><span class="n">smo_data</span><span class="p">)),</span>
                  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_text_repel</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">waza_coord1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">waza_coord2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nf">colnames</span><span class="p">(</span><span class="n">smo_data</span><span class="p">)),</span>
                  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#34;Correspondence Analysis&#34;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">&#34;dim1&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;dim2&#34;</span><span class="p">)</span>

<span class="n">p</span>
</code></pre></div><p><img src="/post/correspondenceanalysis/CAplot.png" alt=""></p>
<h2 id="結果の解釈">結果の解釈</h2>
<p>以上の結果の解釈をしてみます。</p>
<p>まず、軸の寄与率を確認すると、第1軸で0.463、第2軸で0.248です。累積寄与率は0.711ですから、作成した同時付置図でデータの全分散の71%を説明できることになります。第3軸以降を用いて付置図を作成することも寄与率によっては勧められますが、ここでは71%の寄与率で十分とします。</p>
<p>では図の解釈に移ります。<br>
同時付置図は各ポイントの相対的な位置関係と各軸に対する配置を基に考察されます。</p>
<p>まずはポイントの相対的な位置関係から。<br>
ポイント間の距離は、主成分ベクトルによる写像を受けながらも、$\mathbf{χ}^2$距離に由来したものであることから、ポイント間の類似性を示します。ここで注意しなければならないことは、行項目、列項目は同じ軸上に付置されるものの、行項目同士・列項目同士の距離は定義されるが、行項目と列項目間の距離は定義されていない、ということです。
なので、例えば図の左下のほうに付置した貴闘力、隆三杉、春日富士は似たような決まり手を持つ力士である、というように解釈していくことになります。</p>
<p>次に各軸に対する配置を見てみます。<br>
ここでは各ポイントの配置から、軸に解釈を与えたりします。参考の論文では以下のような解釈をしています。</p>
<blockquote>
<p>第1主成分ベクトルでは「押し」、「引き」の係数が正の値で、「投げ」の係数が負の値で絶対値が大きく、第1軸は「突き押し型」^「投げを得意とする型」を表していると考えられる。第2主成分ベクトルでは「引き」、「投げ」、「その他」が正の値で、「寄り」が負の値で絶対値が大きく、第2軸は「組んで取る相撲」-「離れて取る相撲」を表していると考えられる。</p>
</blockquote>
<p>実際に数名の力士の得意技を確認して確かめてみました。<br>
春日富士は、突き、押しが得意な力士だそうで、同時付置図では左下に位置しています。第1軸に関して見れば確かに「突き押し型」の方向に位置することから、春日富士の得意な決まりてが反映された結果になっているようです。<br>
舞の海秀平は関取時代は「平成の牛若丸」、「技のデパート」などと呼ばれたようで、豊富な技を使う力士だったようです。対照的な力士としては安芸乃島勝巳が挙げられ、「寄り」が得意な力士であったようです。第2軸に関して見れば、確かに春日富士は「離れて取る相撲」の方に位置しており、逆に「安芸乃島」は「組んで取る相撲」の方にいます。</p>
<p>このように、対応分析では分割表の数字の羅列から特に意味のある軸を作成し、視覚的に項目間の関係性を把握することができるようになります。</p>
<h1 id="終わりに">終わりに</h1>
<p>対応分析の実践において有用であるにもかかわらず今回説明しなかったことや、次回触れたいことについてまとめておきます。</p>
<h2 id="今回説明できなかったこと">今回説明できなかったこと</h2>
<p><a href="https://shop.ohmsha.co.jp/shopdetail/000000004417/">こちら</a>の文献に、ここで挙げる今回説明できなかったことが説明されています。修士のときも分からん！といいながらもお世話になっていました。</p>
<ul>
<li>
<p>座標軸へのポイントの寄与<br>
これは、座標軸のベクトルを決定するのに寄与しているポイントを意味するもので、各軸にとって重要なポイントを量的に示したものになります。<br>
同時付置図の視覚的判断によらない軸の解釈方法とでもいうべきか？</p>
</li>
<li>
<p>ポイントへの軸の寄与<br>
これは、ポイントが、各座標軸によってどの程度表現されているかを示した数値になります。各ポイントの性質を同時付置図の視覚的判断に依らずに確認できる方法になるのかな？</p>
</li>
<li>
<p>サプリメンタリーポイント<br>
これは、一旦分割表の全行・列を用いて対応分析を実行したとき、同時付置図上で特定のポイントのみが他のポイントから極端に離れて付置される場合にとる手段です。
そのポイントを主成分分析の対象から一旦外し、得られたベクトルもとにそのポイントの写像を得る、という対処をします。</p>
</li>
</ul>
<h2 id="次回触れたいこと">次回触れたいこと</h2>
<p>次回は、座標の不確実性について考えたいと思っています。気付いたかもしれませんが、対応分析の同時付置図における座標は標本数に依存しないので、付置はできるがその信頼区間が分からない、という状態になっています。ベイズモデリングはこの問題への解決策の一つなのかなと考えています。</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>多項分布の正規近似に基づいて、解析的に信頼区間を求めているようで、私が試した方法とは別のアプローチをとっています。 <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p>「クロス集計表」とも呼ばれます。 <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p>主成分分析は変量の次元削減に用いられる手法です。<a href="https://www.morikita.co.jp/books/book/2235">はじパタ</a>に分かりやすい説明があります。Webなら<a href="https://qiita.com/nirperm/items/5178431557f8871e6605">こちら</a>とか。 <a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p><a href="https://shop.ohmsha.co.jp/shopdetail/000000004417/">文献</a>によれば$(3)$式ではなく、$\sqrt{p_{j.}}$こそが$\boldsymbol{X}$の各列の平均値であると仰っているのですが、こちらについては簡単な計算で誤っていると確認したので、参考論文の$(3)$式を正とすることにします。 <a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5" role="doc-endnote">
<p>次元数が多く得られた項目の方については余剰の次元数を寄与率から度外視するのか…？ <a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6" role="doc-endnote">
<p>行項目、列項目に対する主成分分析の結果のうち、得られた次元数が少ない方を次元の数とする、ということなのだが、$\mathrm{min}(m,n)$とはならないのは何故？ <a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7" role="doc-endnote">
<p>RのFactoMineR::CAパッケージなどを使った整合確認は今後の自分に課す課題にします。参考論文における結果と異なるのであやしい気がする…←確認しました。今回の結果とFactoMineR::CAの結果はほぼ一致します。座標に関して言えば小数点第3位程度まで一致しました <a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

        </article>
    </div>
    <div class="main-content__tags u-font">
        
        
        <span><a href="https://rmorita-stat.github.io/tags/%E5%A4%9A%E5%A4%89%E9%87%8F%E8%A7%A3%E6%9E%90">多変量解析</a></span>
        
        
    </div>
</div>
<div class="disqus-comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-rmorita-stat-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
<div class="main-profile">
    <div class="main-profile__avatar">
        
    </div>
    <div class="main-profile__body">
        <div class="main-profile__author">
            
            <span> R.morita </span>
            
        </div>
        <div class="main-profile__description">
            
            <p> 洛中で6年間大学生活を過ごし、今は難波の地で働いています。統計、ロードバイク、古墳が好きです。 </p>
            
        </div>
    </div>
</div>
<div class="main-line"></div>
<div class="main-pn">
    
    <a class="previous" href="https://rmorita-stat.github.io/2020/10/modeling/">
        <div class="pn-dec"></div>
        <div class="pn-els">
            <div class="pn-el__1"> 2020.10.03 00:00 </div>
            <div class="pn-el__2"> モデリングと情報量基準その１～モデリングとは？～ </div>
        </div>
    </a>
    
    
    <a class="next" href="https://rmorita-stat.github.io/2020/12/corresp-and-bayes/">
        <div class="pn-dec"></div>
        <div class="pn-els">
            <div class="pn-el__1"> 2020.12.11 00:00 </div>
            <div class="pn-el__2"> Stanで対応分析の付置にベイズ信頼区間をもたせる </div>
        </div>
    </a>
    
</div>

<footer>
  <script type="text/javascript">
 MathJax = {
   tex: {
     inlineMath: [['$','$'], ['\\(','\\)']],
     processEscapes: true,
     tags: "ams",
     autoload: {
       color: [],
       colorV2: ['color']
     },
     packages: {'[+]': ['noerrors']}
   },
   chtml: {
     matchFontHeight: true,
     displayAlign: "left",
     displayIndent: "2em"
   },
   options: {
     skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
     renderActions: {
        
       find_script_mathtex: [10, function (doc) {
         for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
           const display = !!node.type.match(/; *mode=display/);
           const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
           const text = document.createTextNode('');
           node.parentNode.replaceChild(text, node);
           math.start = {node: text, delim: '', n: 0};
           math.end = {node: text, delim: '', n: 0};
           doc.math.push(math);
         }
       }, '']
     }
   },
   loader: {
     load: ['[tex]/noerrors']
   }
 };
</script>
<script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" id="MathJax-script"></script>
</footer>

</div>
<div class="footer">
    <div class="copyright-wrap">
        <p class="copyright u-font">
            
            &#169;
            2020
            
            <a href="https://github.com/Rmorita-stat/doc" target="_blank">R.morita&#46;</a>
            Theme <a href="https://github.com/iCyris/hugo-theme-yuki" target="_blank">yuki</a>&#46;
            Powered by Hugo&#46;
            
            
        </p>
    </div>
</div>
</body>
<script src="https://rmorita-stat.github.io/js/page.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

